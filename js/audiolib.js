/*
	audiolib.js
	Jussi Kalliokoski
	https://github.com/jussi-kalliokoski/audiolib.js
	MIT license
*//*
	wrapper-start.js
	Please note that the file is not of valid syntax when standalone.
*/this.audioLib=function a(b,c,d,e){function h(a){var b=new f(a);return b.subarray=b.subarray||b.slice,b}function k(a,b,c,d){j?j(a,b,{get:function(){return c},enumerable:!!d}):a[b]=c}function l(a){var b=arguments,c=b.length,d,e;for(d=1;d<c;d++)for(e in b[d])b[d].hasOwnProperty(e)&&(a[e]=b[d][e]);return a}function m(a,b,c){var d;for(d in a)(a.hasOwnProperty(d)||c)&&b.call(a,a[d],d);return a}function n(a,b,c){var d,f;if(!c){c=[],d=/^\s*function\s*\w*\s*\(([^\)]+)/.exec(b);if(d)d[1].replace(/[a-z$_0-9]+/ig,function(a){c.push(a)});else for(d=0;d<b.length;d++)c[d]=e(d+2).join("_")}return f=Function("var __q;return function "+a+"("+c.join()+"){var i; if(__q){__q=!__q}else if(this instanceof "+a+")this.__CLASSCONSTRUCTOR.apply(this,arguments);else{__q=!__q;i=new "+a+";i.__CLASSCONSTRUCTOR.apply(i,arguments);return i}};")(),f.prototype=b.prototype,f.prototype.__CLASSCONSTRUCTOR=b,l(f,b),f}function o(a,b,c,d){this.parameter=a,this.automation=b,this.amount=isNaN(c)?this.amount:c,this.setType(d)}function p(a,b,c,d,e){if(!a.automation){a.automation=[];switch(a.type){case"generator":a.append=p.generatorAppend;break;case"effect":a.append=p.effectAppend;break;case"buffereffect":a.append=p.bufferEffectAppend}}var c=new o(b,c,d,e);return a.automation.push(c),c}function q(a,b,c){function d(){a.apply(this,c)}this.channelCount=isNaN(b)?this.channelCount:b,this.effects=[],d.prototype=a.prototype;while(b--)this.effects.push(new d)}function r(a,b){var c=a[0].toUpperCase()+a.substr(1).toLowerCase();return r[a]=b,b.decode&&(g.Sampler.prototype["load"+c]=function(b){this.load.apply(this,[r[a].decode(b)].concat([].slice.call(arguments,1)))}),b.encode&&(g.AudioDevice.Recording.prototype["to"+c]=function(b){return r[a].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:b})}),b}function s(){var a=e.prototype.splice.call(arguments,0),b=a.prototype=s.prototype;for(i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return a}function t(){}function u(){}function v(a,b){v[a]=b,v._pluginList.push({plugin:b,name:a})}function w(a,b,c,d,e,f,g){this.sampleRate=isNaN(a)?this.sampleRate:a,this.attack=isNaN(b)?this.attack:b,this.decay=isNaN(c)?this.decay:c,this.sustain=isNaN(d)?this.sustain:d,this.release=isNaN(e)?this.release:e,this.sustainTime=isNaN(f)?null:f,this.releaseTime=isNaN(g)?null:g}function x(a,b,c,d){var e=this,f=0;this.sampleRate=isNaN(a)?this.sampleRate:a,this.stepLength=isNaN(b)?this.stepLength:b,this.steps=c||[1,0],this.attack=isNaN(d)?this.attack:d}function y(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.schedule=[],this.reset(b)}function z(a,b,c,d,e,f){this.reset.apply(this,arguments)}function A(a,b){var d=this,e=0;d.sampleRate=a,d.resolution=b?c.pow(2,b-1):c.pow(2,7),d.pushSample=function(a){return e=c.floor(a*d.resolution+.5)/d.resolution,e},d.getMix=function(){return e}}function B(a,b,d,e){function k(){g=new h(f.sampleRate*.1),i=0;var a,b=g.length;for(a=0;a<b;a++)g[a]=0}var f=this,g,i,j;f.delayTime=b||30,f.depth=d||3,f.freq=e||.1,f.sampleRate=a,f.osc=new M(a,e),f.calcCoeff=k,f.pushSample=function(a){++i>=g.length&&(i=0),g[i]=a,f.osc.generate();var b=f.delayTime+f.osc.getMix()*f.depth;b*=f.sampleRate/1e3,b=i-c.floor(b);while(b<0)b+=g.length;return j=g[b],j},f.getMix=function(){return j},k()}function C(a,b,c,d){var e=this;e.sampleRate=a,e.buffer=new h(isNaN(b)?1200:b),e.bufferSize=e.buffer.length,e.feedback=isNaN(c)?e.feedback:c,e.damping=isNaN(d)?e.damping:d,e.invDamping=1-e.damping}function D(a,b,c){var d=this,e=0;d.sampleRate=a,d.scale=b||1,d.gain=c||.5,d.pushSample=function(a){return a/=d.scale,e=(1+d.gain)*a-d.gain*a*a*a,e},d.getMix=function(){return e}}function E(a,b,c){var d=this;d.time=isNaN(b)?d.time:b,d.feedback=isNaN(c)?d.feedback:c,d.reset(a)}function F(a){var b=new I(a,720.484),d=new I(a,723.431),e=new I(a,1),f=0;this.gain=4,this.master=1,this.sampleRate=a,this.filters=[b,d,e],this.pushSample=function(a){return b.pushSample(a),f=b.getMix(1)*this.gain,f=c.atan(f)+f,f>.4?f=.4:f<-0.4&&(f=-0.4),d.pushSample(f),e.pushSample(d.getMix(0)),f=e.getMix(1)*this.master,f},this.getMix=function(){return f}}function G(a,b,c,d,e,f,h){var i=this;i.sampleRate=a,i.channelCount=isNaN(b)?i.channelCount:b,i.wet=isNaN(c)?i.wet:c,i.dry=isNaN(d)?i.dry:d,i.roomSize=isNaN(e)?i.roomSize:e,i.damping=isNaN(f)?i.damping:f,i.tuning=new G.Tuning(h||i.tuning),i.sample=function(){var a=[],b;for(b=0;b<i.channelCount;b++)a[b]=0;return a}(),i.CFs=function(){var a=[],b=[],c=i.tuning.combCount,d=i.damping*i.tuning.scaleDamping,e=i.roomSize*i.tuning.scaleRoom+i.tuning.offsetRoom,f=i.tuning.combTuning,h,j;for(j=0;j<i.channelCount;j++){for(h=0;h<c;h++)b.push(new g.CombFilter(i.sampleRate,f[h]+j*i.tuning.stereoSpread,e,d));a.push(b),b=[]}return a}(),i.numCFs=i.CFs[0].length,i.APFs=function(){var a=[],b=[],c=i.tuning.allPassCount,d=i.tuning.allPassFeedback,e=i.tuning.allPassTuning,f,g;for(g=0;g<i.channelCount;g++){for(f=0;f<c;f++)b.push(new G.AllPassFilter(i.sampleRate,e[f]+g*i.tuning.stereoSpread,d));a.push(b),b=[]}return a}(),i.numAPFs=i.APFs[0].length}function H(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.gain=isNaN(b)?this.gain:b}function I(a,b,d,e){function o(){h=2*l(c.PI*m(.25,f.cutoff/(f.samplerate*2))),i=m(2*(1-n(f.resonance,.25)),m(2,2/h-h*.5))}var f=this,g=[0,0,0,0],h,i,j,k,l=c.sin,m=c.min,n=c.pow;f.cutoff=b?b:2e4,f.resonance=d?d:.1,f.samplerate=a,f.type=e||0,f.pushSample=function(a){if(j!==f.cutoff||k!==f.resonance)o(),j=f.cutoff,k=f.resonance;return g[3]=a-i*g[2],g[0]=g[0]+h*g[2],g[1]=g[3]-g[0],g[2]=h*g[1]+g[2],g[3]=a-i*g[2],g[0]=g[0]+h*g[2],g[1]=g[3]-g[0],g[2]=h*g[1]+g[2],g[f.type]},f.getMix=function(a){return g[a||f.type]}}function J(a,b,c,d){this.sampleRate=isNaN(a)?this.sampleRate:a,this.threshold=isNaN(b)?this.threshold:b,this.attack=isNaN(c)?this.attack:c,this.decay=isNaN(d)?this.decay:d,this._amplitude=new g.Amplitude(this.sampleRate,this.attack,this.decay)}function K(a,b,d){function o(){i=h*e.cutoff/e.samplerate,j=1-i/(2*(e.resonance+.5/(1+i))+i-2),k=j*j,l=k+1-2*c.cos(i)*j}var e=this,f=0,g=0,h=c.PI*2,i,j,k,l,m,n;e.cutoff=b?b:2e4,e.resonance=d?d:1,e.samplerate=a,e.pushSample=function(a){if(m!==e.cutoff||n!==e.resonance)o(),m=e.cutoff,n=e.resonance;return f+=(a-g)*l,g+=f,f*=k,g},e.getMix=function(){return g},o()}function L(){this.reset.apply(this,arguments)}function M(a,b){var c=this;c.frequency=isNaN(b)?440:b,c.waveTable=new h(1),c.sampleRate=a,c.waveShapes=c.waveShapes.slice(0)}function N(a,b){var c=this;c.voices=[],c.sampleRate=a,c.pitch=isNaN(b)?440:c.pitch}function O(a,b,c){this.sampleRate=isNaN(a)?this.sampleRate:a,this.attack=isNaN(b)?this.attack:b,this.decay=isNaN(c)?this.decay:c}function P(a){var b;for(b in P.prototype)P.prototype.hasOwnProperty(b)&&(this[b]=P.prototype[b]);this.resetBuffer.apply(this,arguments)}var f=b.Float32Array||e,g=this;g.Float32Array=h;var j=function(){if(d.defineProperty)return d.defineProperty;if(d.prototype.__defineGetter__)return function(a,b,c){c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)}}();k(g,"__define",j),k(g,"__defineConst",k),k(g,"__extend",l),k(g,"__enum",m),k(g,"__class",n),o.prototype={parameter:"",automation:null,amount:1,type:"modulation",mode:null,setType:function(a){a?(typeof a=="function"&&(this.type=a.name||"custom",this.mode=a),this.type=a,this.mode=p.modes[a]):this.mode=this.mode||p.modes[this.type]}},p.generatorAppend=function(a,b,c){var d=this,e=a.length,f=d.automation.length,g=[],h,i,j,k,l;c=c||a,b=b||d.channelCount;for(k=0;k<f;k++)g.push(d[d.automation[k].parameter]);for(i=0,h=0;i<e;i+=b,h++){for(k=0;k<f;k++)d[d.automation[k].parameter]=g[k];for(k=0;k<f;k++)l=d.automation[k],l.mode(d,l.parameter,l.amount*l.automation.generatedBuffer[h]);d.generate();for(j=0;j<b;j++)c[i+j]=d.getMix(j)*d.mix+a[i+j]}for(k=0;k<f;k++)d[d.automation[k].parameter]=g[k];return c},p.effectAppend=function(a,b,c){var d=this,e=a.length,f=d.automation.length,g=[],h,i,j,k,l;c=c||a,b=b||d.channelCount;for(k=0;k<f;k++)g.push(d[d.automation[k].parameter]);for(i=0,h=0;i<e;i+=b,h++){for(k=0;k<f;k++)d[d.automation[k].parameter]=g[k];for(k=0;k<f;k++)l=d.automation[k],l.mode(d,l.parameter,l.amount*l.automation.generatedBuffer[h]);for(j=0;j<b;j++)d.pushSample(a[i+j],j),c[i+j]=d.getMix(j)*d.mix+a[i+j]*(1-d.mix)}for(k=0;k<f;k++)d[d.automation[k].parameter]=g[k];return c},p.bufferEffectAppend=function(a,b,c){var d=this,e=b||d.channelCount,f=a.length,g=d.automation.length,h=[],i,j,k,l,m,n;c=c||a;for(k=0;k<g;k++){h.push([]);for(j=0;j<e;j++)h[k].push(d.effects[j][d.automation[k].parameter])}for(n=0,i=0;i<f;i+=e,n++)for(j=0;j<e;j++){for(k=0;k<g;k++)m=d.automation[k],d.effects[j][m.parameter]=h[k][j],m.mode(d.effects[j],m.parameter,m.amount*m.automation.generatedBuffer[n]);c[i+j]=d.effects[j].pushSample(a[i+j])*d.mix+a[i+j]*(1-d.mix)}for(k=0;k<g;k++)for(j=0;j<e;j++)d.effects[j][d.automation[k].parameter]=h[k][j];return c},p.modes={modulation:function(a,b,c){a.setParam(b,a[b]*c)},addition:function(a,b,c){a.setParam(b,a[b]+c)},subtraction:function(a,b,c){a.setParam(b,a[b]-c)},additiveModulation:function(a,b,c){a.setParam(b,a[b]+a[b]*c)},subtractiveModulation:function(a,b,c){a.setParam(b,a[b]-a[b]*c)},assignment:function(a,b,c){a.setParam(b,c)},absoluteAssignment:function(a,b,d){a.setParam(b,c.abs(d))}},p.__constructror=o,q.prototype={mix:.5,type:"buffereffect",channelCount:2,append:function(a,b,c){var d=this,e=a.length,f,g;b=b||d.channelCount,c=c||a;for(f=0;f<e;f+=b)for(g=0;g<b;g++)d.effects[g].pushSample(a[f+g],0),c[f+g]=d.effects[g].getMix(0)*d.mix+a[f+g]*(1-d.mix);return c},join:function(){return BufferEffectChain.apply(0,[this].concat(e.prototype.splice.call(arguments,0)))},addPreProcessing:function(){var a;for(a=0;a<this.effects.length;a++)this.effects[a].addPreProcessing.apply(this.effects[a],arguments)},removePreProcessing:function(){var a;for(a=0;a<this.effects.length;a++)this.effects[a].removePreProcessing.apply(this.effects[a],arguments)},setParam:function(a,b){var c=this.effects.length,d;for(d=0;d<c;d++)this.effects[d].setParam(a,b)}},function(a){s.prototype=a,a.pushSample=function(a){var b=this,c,d;for(d=0;d<b.length;d++)c=b[d].mix,a=b[d].pushSample(a)*c+a*(1-c);return a}}(new t),t.prototype={type:"effect",sink:!0,source:!0,mix:.5,channelCount:1,append:function(a,b,c){var d=a.length,e,f;c=c||a,b=b||this.channelCount;for(e=0;e<d;e+=b)for(f=0;f<b;f++)this.pushSample(a[e+f],f),c[e+f]=this.getMix(f)*this.mix+a[e+f]*(1-this.mix);return c},join:function(){return s.apply(0,[this].concat(e.prototype.splice.call(arguments,0)))},addPreProcessing:function(a){a.pushSample=this.pushSample,this.pushSample=function(){return a.apply(this,arguments),a.pushSample.apply(this,arguments)}},removePreProcessing:function(a){var b;while(b=this.pushSample.pushSample)if(b===a||!a)this.pushSample=b,a.pushSample=null},setParam:function(a,b){this[a]=b}},u.prototype={type:"generator",source:!0,mix:1,generatedBuffer:null,channelCount:1,append:function(a,b,c){var d=a.length,e,f;c=c||a,b=b||this.channelCount;for(e=0;e<d;e+=b){this.generate();for(f=0;f<b;f++)c[e+f]=this.getMix(f)*this.mix+a[e+f]}return c},addPreProcessing:function(a){a.generate=this.generate,this.generate=function(){return a.apply(this,arguments),a.generate.apply(this,arguments)}},removePreProcessing:function(a){var b;while(b=this.generate.generate)if(b===a||!a)this.generate=b,a.generate=null},generateBuffer:function(a,b){this.generatedBuffer=new h(a),this.append(this.generatedBuffer,b||1)},setParam:function(a,b){this[a]=b}},k(v,"_pluginList",[],!1),w.prototype={sampleRate:44100,attack:50,decay:50,sustain:1,release:50,value:0,state:3,gate:!1,sustainTime:null,releaseTime:null,_st:0,generate:function(){return this.states[this.state].call(this),this.value},getMix:function(){return this.value},triggerGate:function(a){a=typeof a=="undefined"?!this.gate:a,this.gate=a,this.state=a?0:this.releaseTime===null?3:5,this._st=0},states:[function(){this.value+=1e3/this.sampleRate/this.attack,this.value>=1&&(this.state=1)},function(){this.value-=1e3/this.sampleRate/this.decay*this.sustain,this.value<=this.sustain&&(this.sustainTime===null?this.state=2:(this._st=0,this.state=4))},function(){this.value=this.sustain},function(){this.value=c.max(0,this.value-1e3/this.sampleRate/this.release)},function(){this.value=this.sustain,this._st++>=this.sampleRate*.001*this.sustainTime&&(this._st=0,this.state=this.releaseTime===null?3:5)},function(){this.value=c.max(0,this.value-1e3/this.sampleRate/this.release),this._st++>=this.sampleRate*.001*this.releaseTime&&(this._st=0,this.state=0)}]},x.prototype={sampleRate:44100,stepLength:200,steps:null,value:0,attack:0,phase:0,generate:function(){var a=this,b=a.sampleRate/1e3*a.stepLength,d=a.steps,e=b*d.length,f,g,h,i,j;return a.phase=(a.phase+1)%e,f=a.phase/e*d.length,g=f%1,f=c.floor(f),h=(f||d.length)-1,i=d[f]-d[h],j=d[f],g<a.attack&&(j-=i-i/a.attack*g),a.value=j,j},getMix:function(){return this.value},triggerGate:function(){this.phase=0}},y.prototype={sampleRate:44100,value:1,schedule:null,clock:0,getMix:function(){return this.value},generate:function(){var a;for(a=0;a<this.schedule.length;a++)this.schedule[a].t--&&(this.value=this.schedule[a].v,this.schedule.splice(a--,1))},setValue:function(a){this.schedule.push({v:a,t:~~((+(new Date)-this.clock)/1e3*this.sampleRate)})},reset:function(a){this.value=isNaN(a)?this.value:a,this.clock=+(new Date)}},z.BiquadFilterClass=function R(){var a;for(a in R.prototype)R.prototype.hasOwnProperty&&(this[a]=this[a])},z.BiquadFilterClass.prototype={sampleRate:44100,sample:0,inputs:null,outputs:null,coefs:null,pushSample:function(a){var b=this.coefs,c=this.inputs,d=this.outputs;return this.sample=b.b0*a+b.b1*c[0]+b.b2*c[1]-b.a1*d[0]-b.a2*d[1],c.pop(),c.unshift(a),d.pop(),d.unshift(this.sample),this.sample},getMix:function(){return this.sample},reset:function(a,b,c,d,e,f){this.inputs=[0,0],this.outputs=[0,0],this.sampleRate=isNaN(a)?this.sampleRate:a,arguments.length>1&&(this.coefs={b0:b,b1:c,b2:d,a1:e,a2:f})}},z.LowPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=(1-f)/2,j=1-f,k=i,l=1+h,m=-2*f,n=1-h;this.reset(a,i/l,j/l,k/l,m/l,n/l)},z.HighPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=(1+f)/2,j=-(1+f),k=i,l=1+h,m=-2*f,n=1-h;this.reset(a,i/l,j/l,k/l,m/l,n/l)},z.AllPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=1-h,j=-2*f,k=1+h,l=k,m=j,n=i;this.reset(a,i/l,j/l,k/l,m/l,n/l)},z.BandPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=c.log(2)/2*d*e/g,i=g*(c.exp(h)-c.exp(-h))/2,j=i,k=0,l=-i,m=1+i,n=-2*f,o=1-i;this.reset(a,j/m,k/m,l/m,n/m,o/m)},function(a,b){for(b=0;b<a.length;b++)a[b].prototype=new z.BiquadFilterClass}([z,z.LowPass,z.HighPass,z.AllPass,z.BandPass]),C.prototype={sample:0,index:0,store:0,feedback:.84,damping:.2,pushSample:function(a){var b=this;return b.sample=b.buffer[b.index],b.store=b.sample*b.invDamping+b.store*b.damping,b.buffer[b.index++]=a+b.store*b.feedback,b.index>=b.bufferSize&&(b.index=0),b.sample},getMix:function(){return this.sample},reset:function(){this.index=this.store=0,this.samples=0,this.buffer=new h(this.bufferSize)},setParam:function(a,b){switch(a){case"damping":this.damping=b,this.invDamping=1-b;break;default:this[a]=b}}},E.prototype={sampleRate:1,bufferPos:0,buffer:null,time:1e3,feedback:0,sample:0,_rstf:1,pushSample:function(a){var b=this,c=b.buffer;return c[b.bufferPos++]+=a,b.bufferPos>b.time*b._rstf&&(b.bufferPos=0),b.sample=c[b.bufferPos],c[b.bufferPos]*=b.feedback,b.sample},getMix:function(){return this.sample},resample:function(a){var b=this,d=b.time/a;return b.buffer=g.Sink.resample(b.buffer,a),b.time=a,b.bufferPos=c.round(d*b.bufferPos),b.buffer},reset:function(a,b){var d=this,e=d.buffer,f,i;a=isNaN(a)?d.sampleRate:a,i=d.sampleRate/a,d.buffer=new h(a*E.MAX_DELAY),d.bufferPos=c.round(i*d.bufferPos),d._rstf=.001*a;if(b){e=g.Sink.resample(e,i);for(f=0;f<e.length&&f<d.buffer.length;f++)d.buffer[f]=e[f]}return d.buffer}},E.MAX_DELAY=2,G.prototype={channelCount:2,sample:[0,0],wet:.5,dry:.55,damping:.2223,roomSize:.5,tuning:{},pushSample:function(a,b){var c=a*this.tuning.fixedGain,d=0,e;for(e=0;e<this.numCFs;e++)d+=this.CFs[b][e].pushSample(c);for(e=0;e<this.numAPFs;e++)d=this.APFs[b][e].pushSample(d);this.sample[b]=d*this.wet+a*this.dry},getMix:function(a){return this.sample[a]},reset:function(){var a,b;for(b=0;b<this.channelCount;b++){for(a=0;a<this.numCFs;a++)this.CFs[b][a].reset();for(a=0;a<this.numAPFs;a++)this.APFs[b][a].reset();this.sample[b]=0}},setParam:function(a,b){var c,d,e,f;switch(a){case"roomSize":this.roomSize=b,c=this.roomSize*this.tuning.scaleRoom+this.tuning.offsetRoom;for(f=0;f<this.channelCount;f++)for(e=0;e<this.numCFs;e++)this.CFs[f][e].setParam("feedback",c);break;case"damping":this.damping=b,d=this.damping*this.tuning.scaleDamping;for(f=0;f<this.channelCount;f++)for(e=0;e<this.numCFs;e++)this.CFs[f][e].setParam("damping",d);break;default:this[a]=b}}},G.Tuning=function(a){var b;if(a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},G.Tuning.prototype={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.9,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},G.AllPassFilter=function(a,b,c){var d=this;d.sampleRate=a,d.buffer=new h(isNaN(b)?500:b),d.bufferSize=d.buffer.length,d.feedback=isNaN(c)?d.feedback:c},G.AllPassFilter.prototype={sample:0,index:0,feedback:.5,pushSample:function(a){var b=this;return bufOut=b.buffer[b.index],b.sample=-a+bufOut,b.buffer[b.index++]=a+bufOut*b.feedback,b.index>=b.bufferSize&&(b.index=0),b.sample},getMix:function(){return this.sample},reset:function(){this.index=0,this.sample=0,this.buffer=new h(this.bufferSize)}},H.prototype={sampleRate:44100,gain:1,sample:0,pushSample:function(a){return this.sample=a*this.gain,this.sample},getMix:function(){return this.sample}},J.prototype={sampleRate:44100,__amplitude:null,threshold:.95,attack:.01,release:.01,sample:0,pushSample:function(a){var b=this._amplitude.pushSample(a)-this.threshold;return this.sample=b>0?a/(1+b):a,this.sample},getMix:function(){return this.sample},setParam:function(a,b){switch(a){case"attack":case"release":this._amplitude[a]=b;default:this[a]=b}}},L.prototype={sampleRate:44100,color:"white",b0:0,b1:0,b2:0,b3:0,b4:0,b5:0,c1:null,c2:null,c3:null,c4:null,q:15,q0:null,q1:null,brownQ:0,value:0,reset:function(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.color=typeof b=="string"?b:this.color,this.c1=(1<<this.q)-1,this.c2=~~(this.c1/3)+1,this.c3=1/this.c1,this.c1=this.c2*6,this.c4=3*(this.c2-1),this.q0=c.exp(-200*c.PI/this.sampleRate),this.q1=1-this.q0},generate:function(){this.value=this[this.color]()},getMix:function(){return this.value},white:function(){var a=c.random();return(a*this.c1-this.c4)*this.c3},pink:function(){var a=this.white();return this.b0=.997*this.b0+.029591*a,this.b1=.985*this.b1+.032534*a,this.b2=.95*this.b2+.048056*a,this.b3=.85*this.b3+.090579*a,this.b4=.62*this.b4+.10899*a,this.b5=.25*this.b5+.255784*a,.55*(this.b0+this.b1+this.b2+this.b3+this.b4+this.b5)},brown:function(){var a=this.white();return this.brownQ=this.q1*a+this.q0*this.brownQ,6.2*this.brownQ}},function(a,b,d,e){d=M.prototype={sampleRate:1,frequency:440,phase:0,phaseOffset:0,pulseWidth:.5,fm:0,waveShape:"sine",_p:0,generate:function(){var a=this,b=+a.frequency,c=a.pulseWidth,d=a.phase;b+=b*a.fm,a.phase=(d+b/a.sampleRate/2)%1,d=(a.phase+a.phaseOffset)%1,a._p=d<c?d/c:(d-c)/(1-c)},getMix:function(){return this[this.waveShape]()},getPhase:function(){return this._p},reset:function(a){this.phase=this._p=isNaN(a)?0:a},setWavetable:function(a){return this.waveTable=a,!0},sine:function(){return c.sin(this._p*a)},triangle:function(){return this._p<.5?4*this._p-1:3-4*this._p},square:function(){return this._p<.5?-1:1},sawtooth:function(){return 1-this._p*2},invSawtooth:function(){return this._p*2-1},pulse:function(){return this._p<.5?this._p<.25?this._p*8-1:1-(this._p-.25)*8:-1},wavetable:function(){return g.Sink.interpolate(this.wavetable,this._p*this.wavetable.length)},waveShapes:[]};for(e=0;e<b.length;e++)d[e]=d[b[e]],d.waveShapes.push(d[e]);M.WaveShape=function(a,b){return b&&(this.prototype[a]=b),this.prototype[a]},M.createMixWave=function(a,b){var c=b.length,d,e;return this.WaveShape(a,function(){d=0;for(e=0;e<c;e++)d+=this[b[e].shape]()*b[e].mix;return d})}}(c.PI*2,["sine","triangle","pulse","sawtooth","invSawtooth","square"]),N.prototype={sampleRate:1,pitch:440,delayStart:0,delayEnd:0,maxVoices:1/0,sampleSize:0,voices:null,sample:null,samples:null,data:null,noteOn:function(a,b){a=isNaN(a)?this.pitch:a;var c=this,d=a/c.pitch,e=c.sampleRate,f=e*c.delayStart,g=c.sampleSize-e*c.delayEnd-1,h={f:a,p:f,s:d,l:g,v:isNaN(b)?1:b};c.voices.push(h);while(c.voices.length>c.maxVoices)g=c.voices.shift(),g.onend&&g.onend();return h},generate:function(){var a=this.voices,b,c;for(b=0;b<a.length;b++)c=a[b],c.p+=c.s,c.p>c.l&&a.splice(b--,1)&&c.onend&&c.onend()},getMix:function(a){var b=this.voices,c=0,d;a=a||0;if(this.samples[a])for(d=0;d<b.length;d++)c+=g.Sink.interpolate(this.samples[a],b[d].p)*b[d].v;return c},load:function(a,b){var c=this,d=c.samples=g.Sink.deinterleave(a.data,a.channelCount),e;if(b)for(e=0;e<d.length;e++)d[e]=g.Sink.resample(d[e],a.sampleRate,c.sampleRate);c.sample=a.data,c.samples=d,c.data=a,c.sampleSize=d[0].length}},function(){function b(){var a=arguments,b=a.length,c,d;for(d=0;d<b;d++)c=a[d],this.postMessage({type:"injection",code:c instanceof Function?"("+String(c)+").call(this);":c})}g.AudioWorker=function(c,d){var e=new(window.MozBlobBuilder||window.BlobBuilder),f,h;e.append("var audioLib = ("+String(a)+"(this, Math, Object, Array));\n");for(f=0;f<g.plugins._pluginList.length;f++)e.append("("+String(g.plugins._pluginList[f])+"());\n");return d&&e.append('this.addEventListener("message",function(e){e.data&&e.data.type==="injection"&&Function(e.data.code).call(this)}, true);\n'),e.append(c instanceof Function?"("+String(c)+").call(this);":c),f=window.URL.createObjectURL(e.getBlob()),h=new Worker(f),h._terminate=h.terminate,h.terminate=function(){return window.URL.revokeObjectURL(id),h._terminate.call(h,arguments)},d&&(h.inject=b),h}}(),function(a,b){function f(a,b){return b?c(a&255)+f(a>>8,b-1):""}function g(a,b){return b?g(a>>8,b-1)+c(255-a&255):""}function h(a,b,c){return c?g(a,b):f(a,b)}function i(a,c){var d=a.length,e=d-1,f=0,g=b.pow,h;if(c)for(h=0;h<d;h++)f+=(255-a.charCodeAt(h))*g(256,e-h);else for(h=0;h<d;h++)f+=a.charCodeAt(h)*g(256,h);return f}function j(a,c,d,e){var f=b.pow,g=b.floor,h=j.convertFromBinary,i=j.convertToBinary,k=a/8,l=f(2,a),m=l/2,n=m-1,o=1/m,p=1/n;return e?d?c?function(a,b){return a=g(a<0?a*m+l:a*n),i(a,k,b)}:function(a,b){return i(g(a*n),k,b)}:c?function(a,b){return i(a<0?a+l:a,k,b)}:function(a,b){return i(a,k,b)}:d?c?function(a,b){var c=h(a,b);return c>n?(c-l)*o:c*p}:function(a,b){return h(a,b)*p}:c?function(a,b){var c=h(a,b);return c>n?c-l:c}:function(a,b){return h(a,b)}}var c=String.fromCharCode,d=!0,e=!1;j.convertToBinary=h,j.convertFromBinary=i,j.fromQ32=j(32,d,d,d),j.toQ32=j(32,d,d,e),j.fromQ24=j(24,d,d,d),j.toQ24=j(24,d,d,e),j.fromQ16=j(16,d,d,d),j.toQ16=j(16,d,d,e),j.fromQ8=j(8,d,d,d),j.toQ8=j(8,d,d,e),j.fromInt32=j(32,d,e,d),j.toInt32=j(32,d,e,e),j.fromInt16=j(16,d,e,d),j.toInt16=j(16,d,e,e),j.fromInt8=j(8,d,e,d),j.toInt8=j(8,d,e,e),j.fromUint32=j(32,e,e,d),j.toUint32=j(32,e,e,e),j.fromUint16=j(16,e,e,d),j.toUint16=j(16,e,e,e),j.fromUint8=j(8,e,e,d),j.toUint8=j(8,e,e,e),a.Binary=j}(this,c),function(a,b){function c(a){this.data=a}function g(a,b,c){var e=b/8;d["read"+a+b]=function(a){return c(this.read(e),a)}}var d=c.prototype={read:function(a){var b=this,c=b.data.substr(0,a);return b.skip(a),c},skip:function(a){var b=this,c=b.data=b.data.substr(a);return b.pointer+=a,c.length},readBuffer:function(a,b,c){var d=this,e="read"+c+b,f=b/8,g=a.length,h=0;while(d.data&&h<g)a[h++]=d[e]();return h}},e,f;for(e in b)f=/to([a-z]+)([0-9]+)/i.exec(e),f&&g(f[1],f[2],b[e]);a.Stream=c,c.newType=g}(this,this.Binary),this.PCMData=function(a,b){function d(a){return(typeof a=="string"?d.decode:d.encode)(a)}return d.decodeFrame=function(a,c,d){if(c===8){var f=new(window.Uint8Array||e)(d.length);(new b(a)).readBuffer(f,8,"Uint");for(c=0;c<d.length;c++)d[c]=(f[c]-127.5)*127.5}else(new b(a)).readBuffer(d,c,"Q");return d},d.encodeFrame=function(b,c){var d=a[(c===8?"fromUint":"fromQ")+c],e=b.length,f="",g;if(c===8)for(g=0;g<e;g++)f+=d(b[g]*127.5+127.5);else for(g=0;g<e;g++)f+=d(b[g]);return f},d.decode=function(a,c){function D(){u=f.read(4),v=f.readUint32(),x=f.read(v),z=B[u]=B[u]||[],u==="data"?(w=~~(v/s),y=C.data=new(typeof h!="undefined"?h:e)(w),d.decodeFrame(x,s*8,y)):z.push(x),c&&(f.data?setTimeout(D,1):c(C))}var f=new b(a),g=f.read(4),i=f.readUint32();f=new b(f.read(i));var j=f.read(4),k=f.read(4),l=f.readUint32(),m=new b(f.read(l)),n=m.readUint16(),o=m.readUint16(),p=m.readUint32(),q=m.readUint32(),r=m.readUint16(),s=r/o,t=m.readUint16(),u,v,w,x,y,z,A,B={},C={channelCount:o,bytesPerSample:r/o,sampleRate:q/r,chunks:B,data:y};if(c)f.data?D():c(C);else while(f.data)D();return C},d.encode=function(b,e){var f=a.fromUint32,g=a.fromUint16,h=b.data,i=b.sampleRate,j=b.channelCount||1,k=b.bytesPerSample||1,l=k*8,m=j*k,n=i*m,o=h.length,p=o*k,q=c.pow(2,l-1)-1,r=[],s="",t,u,v,w;r.push("fmt "+f(16)+g(1)+g(j)+f(i)+f(n)+g(m)+g(l)),r.push("data"+f(p)+d.encodeFrame(h,l)),w=b.chunks;if(w)for(u in w)if(w.hasOwnProperty(u)){t=w[u];for(v=0;v<t.length;v++)s=t[v],r.push(u+f(s.length)+s)}return r=r.join(""),r="RIFF"+f(r.length)+"WAVE"+r,e&&setTimeout(function(){e(r)},1),r},d}(this.Binary,this.Stream),function(a){function b(a,c,d,e){var f=b.sinks,g;for(g in f)if(f.hasOwnProperty(g)&&f[g].enabled)try{return new f[g](a,c,d,e)}catch(h){}throw"No audio sink available."}function d(a){this.boundTo=a,this.buffers=[],a.activeRecordings.push(this)}function f(){}function g(a,c,d,e){d=d||c.prototype,c.prototype=new b.SinkClass,c.prototype.type=a,c.enabled=!e;for(e in d)d.hasOwnProperty(e)&&(c.prototype[e]=d[e]);g[a]=c}d.prototype={add:function(a){this.buffers.push(a)},clear:function(){this.buffers=[]},stop:function(){var a=this.boundTo.activeRecordings,b;for(b=0;b<a.length;b++)a[b]===this&&a.splice(b--,1)},join:function(){var a=0,b=0,c=this.buffers,d,e,f,g=c.length;for(f=0;f<g;f++)a+=c[f].length;d=new h(a);for(f=0;f<g;f++){for(e=0;e<c[f].length;e++)d[b+e]=c[f][e];b+=c[f].length}return d}},b.SinkClass=f,f.prototype={sampleRate:44100,channelCount:2,preBufferSize:4096,writePosition:0,writeMode:"async",channelMode:"interleaved",previousHit:0,ringBuffer:null,ringOffset:0,start:function(a,b,c,d){this.channelCount=isNaN(b)?this.channelCount:b,this.preBufferSize=isNaN(c)?this.preBufferSize:c,this.sampleRate=isNaN(d)?this.sampleRate:d,this.readFn=a,this.activeRecordings=[],this.previousHit=+(new Date),this.asyncBuffers=[],this.syncBuffers=[]},process:function(a,c){this.ringBuffer&&(this.channelMode==="interleaved"?this.ringSpin:this.ringSpinInterleaved).apply(this,arguments),this.writeBuffersSync.apply(this,arguments);if(this.readFn)if(this.channelMode==="interleaved")this.readFn.apply(this,arguments);else{var d=b.deinterleave(a,this.channelCount);this.readFn.apply(this,[d].concat([].slice.call(arguments,1))),b.interleave(d,this.channelCount,a)}this.writeBuffersAsync.apply(this,arguments),this.recordData.apply(this,arguments),this.previousHit=+(new Date),this.writePosition+=a.length/c},record:function(){return new d(this)},recordData:function(a){var b=this.activeRecordings,c,d=b.length;for(c=0;c<d;c++)b[c].add(a)},writeBuffersAsync:function(a){var b=this.asyncBuffers,d=a.length,e,f,g,h,i;if(b)for(g=0;g<b.length;g++){e=b[g],f=e.b.length,i=e.d,e.d-=c.min(i,d);for(h=0;h+i<d&&h<f;h++)a[h+i]+=e.b[h];e.b=e.b.subarray(h+i),g>=f&&b.splice(g--,1)}},writeBuffersSync:function(a){var b=this.syncBuffers,c=a.length,d=0,e=0;for(;d<c&&b.length;d++){a[d]+=b[0][e];if(b[0].length>e)e++;else{b.splice(0,1),e=0;continue}}b.length&&(b[0]=b[0].subarray(e))},writeBufferAsync:function(a,c){a=this.mode==="deinterleaved"?b.interleave(a,this.channelCount):a;var d=this.asyncBuffers;return d.push({b:a,d:isNaN(c)?~~((+(new Date)-this.previousHit)/1e3*this.sampleRate):c}),d.length},writeBufferSync:function(a){a=this.mode==="deinterleaved"?b.interleave(a,this.channelCount):a;var c=this.syncBuffers;return c.push(a),c.length},writeBuffer:function(){this[this.writeMode==="async"?"writeBufferAsync":"writeBufferSync"].apply(this,arguments)},getSyncWriteOffset:function(){var a=this.syncBuffers,b=0,c;for(c=0;c<a.length;c++)b+=a[c].length;return b},getPlaybackTime:function(){return this.writePosition-this.preBufferSize},ringSpin:function(a){var b=this.ringBuffer,c=a.length,d=b.length,e=this.ringOffset,f;for(f=0;f<c;f++)a[f]+=b[e],e=(e+1)%d;this.ringOffset=e},ringSpinDeinterleaved:function(a){var b=this.ringBuffer,c=a.length,d=b.length,e=b[0].length,f=d*e,g=this.ringOffset,h,i;for(h=0;h<c;h+=d){for(i=0;i<d;i++)a[h+i]+=b[i][g];g=(g+1)%e}this.ringOffset=i}},g("moz",function(){function l(){if(d){f=e.mozWriteAudio(d),c+=f;if(f<d.length)return d=d.subarray(f),d;d=null}g=e.mozCurrentSampleOffset(),i=Number(g+a.preBufferSize*a.channelCount-c),i>0&&(j=new h(i),a.process(j,a.channelCount),f=e.mozWriteAudio(j),f<j.length&&(d=j.subarray(f)),c+=f)}var a=this,c=0,d=null,e=new Audio,f,g,i,j,k;a.start.apply(a,arguments),a.preBufferSize=isNaN(arguments[2])?a.sampleRate/2:a.preBufferSize,e.mozSetup(a.channelCount,a.sampleRate),a.kill=b.doInterval(l,20),a._bufferFill=l,a._audio=e},{getPlaybackTime:function(){return this._audio.mozCurrentSampleOffset()/this.channelCount}}),g("webkit",function(a,b,c,d){function j(a){var b=a.outputBuffer,c=b.numberOfChannels,d,g,i=b.length,j=b.size,k=new e(c),l=new h(i*c);for(d=0;d<c;d++)k[d]=b.getChannelData(d);f.process(l,f.channelCount);for(d=0;d<i;d++)for(g=0;g<c;g++)k[g][d]=l[d*f.channelCount+g]}var f=this,g=new(window.AudioContext||webkitAudioContext),i=g.createJavaScriptNode(c,0,b);f.start.apply(f,arguments),i.onaudioprocess=j,i.connect(g.destination),f.sampleRate=g.sampleRate,f._context=g,f._node=i,f._callback=j},{kill:function(){},getPlaybackTime:function(){return this._context.currentTime*this.sampleRate}}),g("dummy",function(){function c(){var b=new h(a.preBufferSize*a.channelCount);a.process(b,a.channelCount)}var a=this;a.start.apply(a,arguments),a.kill=b.doInterval(c,a.preBufferSize/a.sampleRate*1e3),a._callback=c},null,!0),b.sinks=b.devices=g,b.Recording=d,b.doInterval=function(a,c){var d=typeof window=="undefined"?undefined:window.MozBlobBuilder||window.WebKitBlobBuilder||window.MSBlobBuilder||window.OBlobBuilder||window.BlobBuilder,e,f,g;if((b.doInterval.backgroundWork||b.devices.moz.backgroundWork)&&d)try{return g=new d,g.append('setInterval(function(){ postMessage("tic"); }, '+c+");"),f=(window.MozURL||window.webkitURL||window.MSURL||window.OURL||window.URL).createObjectURL(g.getBlob()),e=new Worker(f),e.onmessage=function(){a()},function(){e.terminate(),(window.MozURL||window.webkitURL||window.MSURL||window.OURL||window.URL).revokeObjectURL(f)}}catch(h){}return e=setInterval(a,c),function(){clearInterval(e)}},b.doInterval.backgroundWork=!0,function(){function a(c,d){return c&&d?a[c]=d:c&&a[c]instanceof Function&&(b.interpolate=a[c]),a[c]}b.interpolation=a,a("linear",function(a,b){var d=c.floor(b),e=d+1,f=b-d;return e=e<a.length?e:0,a[d]*(1-f)+a[e]*f}),a("nearest",function(a,b){return b<a.length-.5?a[c.round(b)]:a[0]}),a("linear")}(),b.resample=function(a,d,e,f,g){var i=arguments.length,j=i===2?d:i===3?d/e:f/d*g/e,k=a.length,l=c.ceil(k/j),m=new h(l),n,o;for(n=0,o=0;n<k;n+=j)m[o++]=b.interpolate(a,n);return m},b.deinterleave=function(a,b){var c=a.length,d=c/b,e=[],f,g;for(f=0;f<b;f++){e[f]=new h(d);for(g=0;g<d;g++)e[f][g]=a[g*b+f]}return e},b.interleave=function(a,b,c){b=b||a.length;var d=a[0].length,e=a.length,f,g;c=c||new h(d*b);for(f=0;f<e;f++)for(g=0;g<d;g++)c[f+g*b]=a[f][g];return c},b.mix=function(a){var b=[].slice.call(arguments,1),d,e,f;for(f=0;f<b.length;f++){d=c.max(a.length,b[f].length);for(e=0;e<d;e++)a[e]+=b[f][e]}return a},b.resetBuffer=function(a){var b=a.length,c;for(c=0;c<b;c++)a[c]=0;return a},b.clone=function(a,b){var c=a.length,d;b=b||new h(c);for(d=0;d<c;d++)b[d]=a[d];return b},b.createDeinterleaved=function(a,b){var c=new e(b),d;for(d=0;d<b;d++)c[d]=new h(a);return c},a.Sink=b}(function(){return this}()),O.prototype={sampleRate:44100,attack:.01,release:.01,sample:0,pushSample:function(a){return this.sample=c.abs((a>this.sample?this.attack:this.release)*(this.sample-a)+a),this.sample},getMix:function(){return this.sample}},P.prototype={bufferPos:-1,pushSample:function(a){return this.bufferPos=(this
.bufferPos+1)%this.buffer.length,this.bufferPos===0&&this.process(this.buffer),this.buffer[this.bufferPos]=a,a},getMix:function(){return this.buffer[this.bufferPos]},resetBuffer:function(a){this.bufferSize=isNaN(a)?this.bufferSize:a,this.buffer=new h(this.bufferSize),this.bufferPos=-1}};var Q=function(){function e(c,e,f,g){var h=(g?d:-d)*e/f;c[0]=b(h),c[1]=a(h)}function f(a,b,c,d){var f=a.length*.5,g=0,i=0,j=2,k=f/j,l=f/d,m=d/j,n=(j-1)*m,o=new h(2),p,q,r,s,t,u,v,w,x,y;for(p=0;p<l;p++,i+=n){e(o,p,l*j,c);for(q=0;q<m;q++,g++,i++)r=a[2*g],s=a[2*g+1],t=a[2*(g+k)],u=a[2*(g+k)+1],v=r+t,w=s+u,x=r-t,y=s-u,b[2*i]=v,b[2*i+1]=w,b[2*(i+m)]=o[0]*x-o[1]*y,b[2*(i+m)+1]=o[0]*y+o[1]*x}}function g(a,b,c,d){var e=1,g=0,h=a.length*.5,i=c.length,j,k,l,m;for(m=0;m<i;m++)l=c[m],e*=l,g===0?(j=a,k=b,g=1):(j=b,k=a,g=0),l===2&&f(j,k,d,e);if(d){if(g===1)for(m=0;m<h;m++)a[2*m]=b[2*m],a[2*m+1]=b[2*m+1]}else if(g===1)for(m=0;m<h;m++)a[2*m]=b[2*m]/h,a[2*m+1]=b[2*m+1]/h;else for(m=0;m<h;m++)a[2*m]=a[2*m]/h,a[2*m+1]=a[2*m+1]/h}function i(){this.reset.apply(this,arguments)}var a=c.sin,b=c.cos,d=c.PI*2;return i.prototype={factors:null,scratch:null,bufferSize:2048,reset:function(a){this.bufferSize=isNaN(a)?this.bufferSize:this.bufferSize,this.factors=[2,2,2,2,2,2,2,2,2,2],this.scratch=new h(this.bufferSize)},forward:function(a){g(a,this.scratch,this.factors,!0)},backward:function(a){g(a,this.scratch,this.factors,!1)}},i}();return function(a){a.resetFFT=a.reset,a.reset=function(a,b){g.FourierTransform.apply(this,arguments),this.resetBuffer.apply(this,[].slice.call(arguments,1)),this.resetFT.apply(this,arguments),this.resetFFT.apply(this,[].slice.call(arguments,1))},a.process=function(a){return this[this.method](a||this.buffer),this.calculateSpectrum()},a.sampleRate=44100,a.method="forward"}(Q.prototype),this.FourierTransform=function(){function l(a,b){var c;for(c in l.prototype)l.prototype.hasOwnProperty&&(this[c]=l.prototype[c]);P.apply(this,[].slice.call(arguments,1)),this.resetFT.apply(this,arguments)}var a=c.sin,b=c.cos,d=c.sqrt,e=c.floor,f=c.pow,g=c.log,i=c.ln2,j=c.PI,k=j*2;return l.prototype={resetFT:function(a){var b=this;b.sampleRate=isNaN(a)?b.sampleRate:a,b.bandWidth=2/b.bufferSize*b.sampleRate*.5,b.spectrum=new h(b.bufferSize*.5),b.peakBand=0,b.peak=0},getBandFrequency:function(a){return this.bandwidth*a+this.bandWidth*.5},calculateSpectrum:function(){var a=this,b=a.spectrum,c=2/a.bufferSize,e=a.bufferSize/2,f,g,h,i,j;for(i=0;i<e;i++)j=i*2,f=a.buffer[i*2],g=a.buffer[i*2+1],h=c*d(f*f+g*g),h>a.peak&&(a.peakBand=i,a.peak=h),b[i]=h}},l}(),g.ADSREnvelope=w,g.StepSequencer=x,g.UIControl=y,g.BiquadFilter=z,g.BitCrusher=A,g.Chorus=B,g.CombFilter=C,g.Compressor=D,g.Delay=E,g.Distortion=F,g.GainController=H,g.IIRFilter=I,g.LP12Filter=K,g.Reverb=G,g.Noise=L,g.Oscillator=M,g.Sampler=N,g.Amplitude=O,g.FFT=Q,g.AudioProcessingUnit=P,g.AudioDevice=g.Sink=function(){return this}().Sink,function(a,b){function c(a){return new g.BufferEffect(this,a,[].slice.call(arguments,1))}function d(a,b,e,f){if(b){e=e||b.prototype;var g=b.prototype=new t;g.name=g.fxid=a,d[a]=n(a,b,f),d[a].createBufferBased=b.createBufferBased=c;for(f in e)e.hasOwnProperty(f)&&(g[f]=e[f])}return d[a]}g.effects=d;for(b=0;b<a.length;b++)g[a[b]]=d(a[b],g[a[b]],g[a[b]].prototype);d("BiquadAllPassFilter",z.AllPass),d("BiquadBandPassFilter",z.BandPass),d("BiquadHighPassFilter",z.HighPass),d("BiquadLowPassFilter",z.LowPass)}(["BiquadFilter","BitCrusher","Chorus","CombFilter","Compressor","Delay","Distortion","GainController","IIRFilter","LP12Filter","Reverb","Amplitude","FFT"]),function(a,b){function c(a,b,d,e){if(b){d=d||b.prototype;var f=b.prototype=new u;f.name=f.fxid=a,c[a]=n(a,b,e);for(e in d)d.hasOwnProperty(e)&&(f[e]=d[e])}return c[a]}g.generators=c;for(b=0;b<a.length;b++)g[a[b]]=c(a[b],g[a[b]],g[a[b]].prototype)}(["Noise","Oscillator","Sampler","ADSREnvelope","StepSequencer","UIControl"]),r("wav",g.PCMData),g.Automation=p,g.BufferEffect=q,g.EffectChain=s,g.EffectClass=t,g.GeneratorClass=u,g.codecs=g.Codec=r,g.plugins=v,g.version="0.5.1",g.BufferEffect.prototype.addAutomation=g.EffectClass.prototype.addAutomation=g.GeneratorClass.prototype.addAutomation=function(){return g.Automation.apply(g,[this].concat([].slice.call(arguments)))},g}.call(typeof exports=="undefined"?{}:this,this.window||global,Math,Object,Array)